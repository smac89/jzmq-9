language: java
addons:
 # hostname monkeying needed for openjdk, see travis-ci/travis-ci#5227 for details
 hosts:
 - myshorthost
 apt:
  update: true
  packages:
   - build-essential
   - libpgm-dev
   - make
   - pkg-config
   - libtool
   - automake
 hostname: myshorthost

before_script:
 - git clone git://github.com/jedisct1/libsodium.git
 - cd libsodium
 - ./autogen.sh
 - ./configure && make
 - sudo make install
 - sudo ldconfig
 - cd ..
 - git clone https://github.com/zeromq/libzmq.git
 - cd libzmq
 - ./autogen.sh
 - ./configure --with-libsodium && make
 - sudo make install
 - sudo ldconfig
 - cd ..

script: ./gradlew test
after_script: ./gradlew --no-daemon publishToMavenLocal

jdk:
 - oraclejdk9
 - oraclejdk11
 - openjdk9
 - openjdk11
